(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{1256:function(t,e,i){"use strict";(function(t,n){var a=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;a(i("ced3")),a(i("4a84"));var s={data:function(){return{device_ids:"",api_key:"",comments:"",trigger_time:"",canvasnamelist:["canvasGauge0","canvasGauge1"],title:"Hello",username:"",intervalId:null,seen_id:0,val:[0,1],cWidth:"",cHeight:"",pixelRatio:1,temp_index:0,all_count:null,charts_len:7,res_time:"",input_val:[null,null,null,null,null,null,null,null],temp_data:{},res_data1:[],direction:"https://api.heclouds.com"}},onLoad:function(e){console.log("Op:",e),this.username=e=={}?"test":e.username,this.check_main(),this.dataRefresh(),this,this.cWidth=t.upx2px(750),this.cHeight=t.upx2px(500)},onReady:function(){},methods:{quit:function(t){n.navigateTo({url:"../index/index"})},fresh:function(){console.log("fresh"),this.check_main()},dataRefresh:function(){var t=this;null==this.intervalId&&(this.intervalId=setInterval((function(){console.log("刷新 "+new Date),t.fresh()}),1e4))},clear:function(){clearInterval(this.intervalId),this.intervalId=null},created:function(){this.dataRefresh()},destroyed:function(){this.clear()},check_main:function(){console.log("check once");this.device_ids=t.getStorageSync("device_ids"),this.api_key=t.getStorageSync("api_key"),this.comments=t.getStorageSync("comments"),this.trigger_time=t.getStorageSync("trigger_time");for(var e=this.device_ids.split(","),i=this.comments.split(","),n={},a=0;a<e.length;a++)n[e[a]]={comments:i[a],status:"离线",datastreams:[]};t.request({url:this.direction+"/devices/status",header:{"api-key":this.api_key},data:{devIds:this.device_ids},method:"GET",success:function(t){console.log("返回status",t.data["data"]);for(var e=0;e<t.data["data"]["devices"].length;e++){var i=t.data["data"]["devices"][e];1==i["online"]&&(n[i["id"]]["status"]="在线")}}}),t.request({url:this.direction+"/devices/datapoints",header:{"api-key":this.api_key},data:{devIds:this.device_ids},method:"GET",success:function(t){for(var e=0;e<t.data["data"]["devices"].length;e++){var i=t.data["data"]["devices"][e];n[i["id"]]["datastreams"]=i["datastreams"]}}}),this.temp_data=n},send:function(e,i,n){t.request({url:this.direction+"/cmds?device_id="+e,header:{"api-key":this.api_key},data:{key_name:i,action:n,period:this.trigger_time},method:"POST",success:function(e){t.showToast({title:"成功",icon:"none"})}})},change:function(){this.input_val[0]&&t.setStorageSync("device_ids",this.input_val[0]),this.input_val[1]&&t.setStorageSync("comments",this.input_val[1]),this.input_val[2]&&t.setStorageSync("api_key",this.input_val[2]),this.input_val[3]&&t.setStorageSync("trigger_time",this.input_val[3]),this.check_main(),t.showToast({title:"成功",icon:"none"})},init_info:function(){this.input_val[0]=this.device_ids,this.input_val[1]=this.comments,this.input_val[2]=this.api_key,this.input_val[3]=this.trigger_time,this.$forceUpdate()}}};e.default=s}).call(this,i("543d")["default"],i("bc2e")["default"])},"26a0":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,i=(t._self._c,0==t.seen_id?t.__map(t.temp_data,(function(e,i){var n=t.__get_orig(e),a=t.__map(e.datastreams,(function(e,i){var n=t.__get_orig(e),a=e["at"].slice(0,10),s=e["at"].slice(11,19);return{$orig:n,g0:a,g1:s}}));return{$orig:n,l0:a}})):null);t._isMounted||(t.e0=function(e){t.seen_id=0,t.check_main()},t.e1=function(e){t.seen_id=1,t.init_info()}),t.$mp.data=Object.assign({},{$root:{l1:i}})},a=[]},"473b":function(t,e,i){"use strict";(function(t,e){var n=i("4ea4");i("7e2e");n(i("66fd"));var a=n(i("57d0"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(a.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},"4a12":function(t,e,i){},"57d0":function(t,e,i){"use strict";i.r(e);var n=i("26a0"),a=i("c601");for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);i("845d");var c=i("f0c5"),o=Object(c["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=o.exports},"845d":function(t,e,i){"use strict";var n=i("4a12"),a=i.n(n);a.a},c601:function(t,e,i){"use strict";i.r(e);var n=i("1256"),a=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a}},[["473b","common/runtime","common/vendor"]]]);